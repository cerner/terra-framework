{"version":3,"file":"time.js","sourceRoot":"","sources":["../../source/utils/time.ts"],"names":[],"mappings":"AAAA,OAAO,EAAC,YAAY,EAAC,MAAM,2BAA2B,CAAC;AAOvD,oCAAoC;AACpC,MAAM,CAAC,MAAM,OAAO,GAAG,KAAK,EAC3B,OAAgB,EAChB,eAA4C,EAC5C,OAAuB,EACH,EAAE,CACtB,IAAI,OAAO,CAAC,CAAC,OAAO,EAAE,MAAM,EAAE,EAAE;IAC/B,MAAM,SAAS,GAAG,UAAU,CAAC,GAAG,EAAE;QACjC,IAAI,eAAe,EAAE;YACpB,eAAe,CAAC,KAAK,EAAE,CAAC;SACxB;QAED,MAAM,CAAC,IAAI,YAAY,CAAC,OAAO,CAAC,CAAC,CAAC;IACnC,CAAC,EAAE,OAAO,CAAC,OAAO,CAAC,CAAC;IAEpB,KAAK,OAAO;SACV,KAAK,CAAC,OAAO,CAAC;SACd,IAAI,CAAC,OAAO,CAAC;SACb,KAAK,CAAC,MAAM,CAAC;SACb,IAAI,CAAC,GAAG,EAAE;QACV,YAAY,CAAC,SAAS,CAAC,CAAC;IACzB,CAAC,CAAC,CAAC;AACL,CAAC,CAAC,CAAC;AAEJ,MAAM,CAAC,MAAM,KAAK,GAAG,KAAK,EAAE,EAAU,EAAE,EAAE,CAAC,IAAI,OAAO,CAAC,OAAO,CAAC,EAAE;IAChE,UAAU,CAAC,OAAO,EAAE,EAAE,CAAC,CAAC;AACzB,CAAC,CAAC,CAAC","sourcesContent":["import {TimeoutError} from '../errors/TimeoutError.js';\n\nexport type TimeoutOptions = {\n\ttimeout: number;\n\tfetch: typeof fetch;\n};\n\n// `Promise.race()` workaround (#91)\nexport const timeout = async (\n\trequest: Request,\n\tabortController: AbortController | undefined,\n\toptions: TimeoutOptions,\n): Promise<Response> =>\n\tnew Promise((resolve, reject) => {\n\t\tconst timeoutId = setTimeout(() => {\n\t\t\tif (abortController) {\n\t\t\t\tabortController.abort();\n\t\t\t}\n\n\t\t\treject(new TimeoutError(request));\n\t\t}, options.timeout);\n\n\t\tvoid options\n\t\t\t.fetch(request)\n\t\t\t.then(resolve)\n\t\t\t.catch(reject)\n\t\t\t.then(() => {\n\t\t\t\tclearTimeout(timeoutId);\n\t\t\t});\n\t});\n\nexport const delay = async (ms: number) => new Promise(resolve => {\n\tsetTimeout(resolve, ms);\n});\n"]}
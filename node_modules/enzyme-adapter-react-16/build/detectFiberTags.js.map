{"version":3,"file":"detectFiberTags.js","names":["getFiber","element","container","global","document","createElement","inst","Tester","React","Component","ReactDOM","render","_reactInternalFiber","child","getLazyFiber","LazyComponent","SuspenseWrapper","Suspense","fallback","detectFiberTags","supportsMode","StrictMode","supportsContext","createContext","supportsForwardRef","forwardRef","supportsMemo","memo","supportsProfiler","unstable_Profiler","Profiler","supportsSuspense","supportsLazy","lazy","Fn","Cls","Ctx","FwdRef","props","ref","fakeDynamicImport","HostRoot","tag","ClassComponent","Fragment","FunctionalComponent","MemoSFC","MemoClass","HostPortal","createPortal","HostComponent","HostText","Mode","ContextConsumer","Consumer","ContextProvider","Provider","value","ForwardRef","id","onRender","Lazy"],"sources":["../src/detectFiberTags.js"],"sourcesContent":["import React from 'react';\nimport ReactDOM from 'react-dom';\nimport { fakeDynamicImport } from 'enzyme-adapter-utils';\n\nfunction getFiber(element) {\n  const container = global.document.createElement('div');\n  let inst = null;\n  class Tester extends React.Component {\n    render() {\n      inst = this;\n      return element;\n    }\n  }\n  ReactDOM.render(React.createElement(Tester), container);\n  return inst._reactInternalFiber.child;\n}\n\nfunction getLazyFiber(LazyComponent) {\n  const container = global.document.createElement('div');\n  let inst = null;\n  // eslint-disable-next-line react/prefer-stateless-function\n  class Tester extends React.Component {\n    render() {\n      inst = this;\n      return React.createElement(LazyComponent);\n    }\n  }\n  // eslint-disable-next-line react/prefer-stateless-function\n  class SuspenseWrapper extends React.Component {\n    render() {\n      return React.createElement(\n        React.Suspense,\n        { fallback: false },\n        React.createElement(Tester),\n      );\n    }\n  }\n  ReactDOM.render(React.createElement(SuspenseWrapper), container);\n  return inst._reactInternalFiber.child;\n}\n\nexport default function detectFiberTags() {\n  const supportsMode = typeof React.StrictMode !== 'undefined';\n  const supportsContext = typeof React.createContext !== 'undefined';\n  const supportsForwardRef = typeof React.forwardRef !== 'undefined';\n  const supportsMemo = typeof React.memo !== 'undefined';\n  const supportsProfiler = typeof React.unstable_Profiler !== 'undefined' || typeof React.Profiler !== 'undefined';\n  const supportsSuspense = typeof React.Suspense !== 'undefined';\n  const supportsLazy = typeof React.lazy !== 'undefined';\n\n  function Fn() {\n    return null;\n  }\n  // eslint-disable-next-line react/prefer-stateless-function\n  class Cls extends React.Component {\n    render() {\n      return null;\n    }\n  }\n  let Ctx = null;\n  let FwdRef = null;\n  let LazyComponent = null;\n  if (supportsContext) {\n    Ctx = React.createContext();\n  }\n  if (supportsForwardRef) {\n    // React will warn if we don't have both arguments.\n    // eslint-disable-next-line no-unused-vars\n    FwdRef = React.forwardRef((props, ref) => null);\n  }\n  if (supportsLazy) {\n    LazyComponent = React.lazy(() => fakeDynamicImport(() => null));\n  }\n\n  return {\n    HostRoot: getFiber('test').return.return.tag, // Go two levels above to find the root\n    ClassComponent: getFiber(React.createElement(Cls)).tag,\n    Fragment: getFiber([['nested']]).tag,\n    FunctionalComponent: getFiber(React.createElement(Fn)).tag,\n    MemoSFC: supportsMemo\n      ? getFiber(React.createElement(React.memo(Fn))).tag\n      : -1,\n    MemoClass: supportsMemo\n      ? getFiber(React.createElement(React.memo(Cls))).tag\n      : -1,\n    HostPortal: getFiber(ReactDOM.createPortal(null, global.document.createElement('div'))).tag,\n    HostComponent: getFiber(React.createElement('span')).tag,\n    HostText: getFiber('text').tag,\n    Mode: supportsMode\n      ? getFiber(React.createElement(React.StrictMode)).tag\n      : -1,\n    ContextConsumer: supportsContext\n      ? getFiber(React.createElement(Ctx.Consumer, null, () => null)).tag\n      : -1,\n    ContextProvider: supportsContext\n      ? getFiber(React.createElement(Ctx.Provider, { value: null }, null)).tag\n      : -1,\n    ForwardRef: supportsForwardRef\n      ? getFiber(React.createElement(FwdRef)).tag\n      : -1,\n    Profiler: supportsProfiler\n      ? getFiber(React.createElement((React.Profiler || React.unstable_Profiler), { id: 'mock', onRender() {} })).tag\n      : -1,\n    Suspense: supportsSuspense\n      ? getFiber(React.createElement(React.Suspense, { fallback: false })).tag\n      : -1,\n    Lazy: supportsLazy\n      ? getLazyFiber(LazyComponent).tag\n      : -1,\n  };\n}\n"],"mappings":"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"}
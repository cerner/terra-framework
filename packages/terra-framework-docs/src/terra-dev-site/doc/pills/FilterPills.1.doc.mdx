import { Badge } from '@cerner/terra-pills/package.json?dev-site-package';
import { Notice } from '@cerner/terra-docs';
import Whitespace from '../../common/layout-helpers/Whitespace';

import AppliedFiltersExample from './example/AppliedFiltersExample?dev-site-example';
import BasicLabelExample from './example/BasicLabelExample?dev-site-example';
import CategoryLabelExample from './example/CategoryLabelExample?dev-site-example';
import TruncatedLabelExample from './example/TruncatedLabelExample?dev-site-example';
import VisibleLabelExample from './example/VisibleLabelExample?dev-site-example';

import FilterPillsPropsTable from '@cerner/terra-pills/src/FilterPills?dev-site-props-table';
import PillsPropsTable from '@cerner/terra-pills/src/subcomponents/_Pill?dev-site-props-table';

<Badge />

# Terra Filter Pills

Pills are generally used to assign a label or keyword to user interface (UI) objects, defining a non-hierarchical group. They are used to visually label UI objects for quick recognition. These labels can be generated either by the system or users entering data.

When using a filter workflow, which removes items from a view that do not satisfy specific criteria, Filter Pills can provide indication as to which facet categories and attributes the user can narrow the content by, helping to further divide content in order to assist users in refining large results.

## What the component is

Filter Pills are comprised of the following:

- Label _(clickable if truncated to disclose the full label)_
- An optional category to help describe the label
- An interactive button to remove the filter

## What the component is not

- Although similar, pills and tags have their own use cases and best practices for when they should be used within the UI. See [tags](https://engineering.cerner.com/terra-ui/components/terra-tag/tag/tag) for more information.
- Although the filtering workflow may narrow down content to drive the user's workflow, it should not be used in the place of primary or secondary navigation.

## Getting Started

- Install with [npmjs](https://www.npmjs.com):
  - `npm install terra-pills`

<!-- AUTO-GENERATED-CONTENT:START Peer Dependencies -->
## Peer Dependencies

This component requires the following peer dependencies be installed in your app for the component to properly function.

| Peer Dependency | Version |
|-|-|
| react | ^16.8.5 |
| react-dom | ^16.8.5 |
| react-intl | >=2.8.0 <6.0.0 |

<!-- AUTO-GENERATED-CONTENT:END -->

## Usage
```jsx
import FilterPills, { Pill } from '@cerner/terra-pills';
```

## Component Features

* [Cross-Browser Support](https://engineering.cerner.com/terra-ui/about/terra-ui/component-standards#cross-browser-support)
* [Responsive Support](https://engineering.cerner.com/terra-ui/about/terra-ui/component-standards#responsive-support)
* [Mobile Support](https://engineering.cerner.com/terra-ui/about/terra-ui/component-standards#mobile-support)

<Whitespace newline={3} />

## Introduction:

Filter Pills can be added to a variety of situations and compositions when it is necessary to display the selected facets being applied to a filtered layout. They can be constructed into in various higher-order component patterns like an **Applied Filters** toolbar, and similar locations that the applied category labels are removable by the user. They also have the ability to flex layouts between an expanded state showing all filter pills, and a collapsed state showing just a single line and roll-up toggle to show and hide the additional filter pills.

<AppliedFiltersExample title='Introduction to Filter Pills: Applied Filters Toolbar' />

<Whitespace newline={3} />

## How To Construct:

### Filter Pill with a basic Label

Filter Pills in their standard form display a single keyword or short phrase as their label. They are also removable, which makes them interactive with the clickable remove ("X") button, as well as by interactive by keyboard, able to be removed by pressing the 'delete' or 'backspace' key when they are in focus.

<BasicLabelExample title="Basic Label" />

<Whitespace />

### Adding an optional Category to the Label

Additional category terms can be added to the single keyword or short phrase label to provide additional clarity in situations where the same keyword label may appear twice (but apply to different groupings), or is needed to help indicate to a user the category groupings the labels belong to.

<CategoryLabelExample title="Adding a Label Category" />

<Whitespace />

### Long Labels & Truncation: A Popup is Added

In cases where the width of the space is constrained and the text label for the Filter Pill is unable to fully display, a popup will automatically be added, the label will become an interactive target. Clicking the label will disclose the full Filter Pill text label (and category if applied) as the contents. No additional content can be added to the popup.

<TruncatedLabelExample title="Selectable Label when Truncated" />

<Whitespace newline={3} />

## Usage Considerations:

### Adding a Visible Label

Filter Pills are commonly used in a group or list, which must include a label to indicate the intent or purpose of the contents of the list. Accordingly, the filter pills component requires the `ariaLabel` prop for accessibility minimum standards, to give a screen reader user the proper context of the list, but it is not visible to users.

<Notice variant="ux-recommendation" ariaLevel="3">

As a best practice, the Filter Pills component should be accompanied by a visible label, which may need to be styled and positioned according to a specific usage and should be done so by each consumer. Use the `ariaLabelledBy` prop in Filter Pills, and provide it the 'id' of the visible label or heading, which will allow for the visible text to be accessibly connected to the pills. Read more details about the construction method in the [Accessibility Guide](/components/cerner-terra-framework-docs/pills/accessibility-guide) and the example below.

</Notice>

Note: _The visible label referenced by the `ariaLabelledBy` prop and the `ariaLabel` prop should be set to the same string values for fallback protection, even though when done properly `ariaLabelledBy` should override `ariaLabel` and the 'aria-labelledby' property will replace the 'aria-label' property in the compiled markup._

<VisibleLabelExample title="Adding a Styled Label or Heading" />

<Whitespace />

### Incorrect Use

Terra Filter Pills contains a specific reusable subcomponent `<Pill/>`. However, the inner 'Pill' subcomponent is not intended to be used alone, or independently without being used properly as children of the `<FilterPills/>` parent container. If used as standalone, the `<Pill/>` offers [no support for accessibility](/components/cerner-terra-framework-docs/pills/accessibility-guide#concerns--hazards) or correct behaviors.

The `<Pill/>` subcomponent was created and tested with the express intent of always being used as children of the `<FilterPills/>` component.

<Notice variant="not-supported" ariaLevel="3">

The example below shows an implementation with the intention of removing the parent `<FilterPills/>` component, such that only a single (or series) of the `<Pill/>` subcomponent remains:

```diff
    <div id="my-incorrect-usage-of-a-pill">
-     <FilterPills
-       ariaLabel="It is incorrect to remove the parent FilterPills"
-     >
        <Pill
          label="Incorrect Use of Pill as standalone"
          id={pill.id}
          metaData={pill.metaData}
          onRemove={handleOnRemove}
        />
-     </FilterPills>
    </div>
```

Consumers should be aware to not intentionally create the above situation. 

</Notice>

<Whitespace newline={5} />

## Props for Filter Pills
<FilterPillsPropsTable />

## Props for Pill subcomponent
<PillsPropsTable />

## Testing

Pills uses `uuid` which changes the component's description id dynamically. To mock the return value with the Jest testing library, `jest.spyOn` can be used.

If Enzyme `shallow` rendering is being used for the tests then the mock may not be required. However, if `mount` is used then `uuid` should be mocked as shown below:

```js
import { v4 as uuidv4 } from 'uuid';

let mockSpyUuid;

// using a variable may result in failures. For best results, mock return value.
beforeAll(() => {
  mockSpyUuid = jest.spyOn(uuidv4, 'v4').mockReturnValue('00000000-0000-0000-0000-000000000000');
});

// restore the mock
afterAll(() => {
  mockSpyUuid.mockRestore();
});

```
